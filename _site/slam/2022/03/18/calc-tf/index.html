<!doctype html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css" integrity="sha384-cg6SkqEOCV1NbJoCu11+bm0NvBRc8IYLRGXkmNrqUBfTjmMYwNKPWBTIKyw9mHNJ" crossorigin="anonymous">
  <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/grids-responsive-min.css">
  <link rel="stylesheet" href="/assets/styles.css">
  <title>Blog of DongUk</title><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Frame간의 Transformation matrix 계산하기 | DongUkSeo</title>
<meta name="generator" content="Jekyll v3.9.1" />
<meta property="og:title" content="Frame간의 Transformation matrix 계산하기" />
<meta name="author" content="DongUk Seo" />
<meta property="og:locale" content="en" />
<meta name="description" content="SLAM분야에서 두 프레임이 주어졌을때 transformation matrix를 구해야하는 상황이 흔히 발생한다." />
<meta property="og:description" content="SLAM분야에서 두 프레임이 주어졌을때 transformation matrix를 구해야하는 상황이 흔히 발생한다." />
<link rel="canonical" href="http://localhost:4000/slam/2022/03/18/calc-tf/" />
<meta property="og:url" content="http://localhost:4000/slam/2022/03/18/calc-tf/" />
<meta property="og:site_name" content="DongUkSeo" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-03-18T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Frame간의 Transformation matrix 계산하기" />
<meta name="google-site-verification" content="xxxxx" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"DongUk Seo","url":"https://github.com/SeoDU/"},"dateModified":"2022-03-18T00:00:00+09:00","datePublished":"2022-03-18T00:00:00+09:00","description":"SLAM분야에서 두 프레임이 주어졌을때 transformation matrix를 구해야하는 상황이 흔히 발생한다.","headline":"Frame간의 Transformation matrix 계산하기","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/slam/2022/03/18/calc-tf/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/logo.png"},"name":"DongUk Seo"},"url":"http://localhost:4000/slam/2022/03/18/calc-tf/"}</script>
<!-- End Jekyll SEO tag -->
<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="DongUkSeo" />

  <link rel="icon" type="image/png" sizes="16x16" href="/iman.png">


</head>


  <body>

    <div class="container pure-g"><div class="sidebar-left pure-u-1 pure-u-md-1-4" style="background-color: rgb(40, 73, 77); color: rgb(255, 255, 255); background-image: url(/bg.jpeg);"><header class="masthead">
  <div class="avatar"><img src="/sdu_profile.jpeg" class="avatar-image" alt="DongUk Seo">
    </div>
  <div class="masthead-title">
    <a href="/" title="Home">DongUkSeo</a>
  </div>
  <div class="masthead-tagline">
    <small>M.S candidate, KAIST</small>
  </div><nav class="navigation">
    <ul class="navigation-list"><li class="navigation-item">
        <a onclick="sessionStorage.setItem('forceCheckScroll', 'true')" href="/">Blog</a>
      </li><li class="navigation-item">
        <a onclick="sessionStorage.setItem('forceCheckScroll', 'true')" href="/about/">About</a>
      </li></ul>
  </nav><div class="social pure-menu pure-menu-horizontal">
      <ul class="social-icons pure-menu-list">
      <li class="pure-menu-item">
          <a class="social-icon pure-menu-link" href="mailto://dongukseo@kaist.ac.kr">
            <i class="fas fa-envelope" title="Email"></i>
          </a>
        </li><li class="pure-menu-item">
          <a class="social-icon pure-menu-link" href="https://github.com/SeoDU">
            <i class="fab fa-github" title="GitHub"></i>
          </a>
        </li><li class="pure-menu-item">
          <a class="social-icon pure-menu-link" href="https://www.youtube.com/channel/UCaON-AWswqdv9hzrOxZDdWA">
            <i class="fab fa-youtube" title="Youtube"></i>
          </a>
        </li>
      </ul>
    </div>
</header>
</div>

      <div class="content pure-u-1 pure-u-md-1-2"><main>
  <article class="post">
  <h1 class="post-title">Frame간의 Transformation matrix 계산하기</h1>
  <div class="post-meta"><time datetime="2022-03-18T00:00:00+09:00" itemprop="datePublished">18 Mar 2022</time></div>

  <p>SLAM분야에서 두 프레임이 주어졌을때 transformation matrix를 구해야하는 상황이 흔히 발생한다.</p>

<h2 id="1-concept">1. Concept</h2>

<p>Transformation from camera to body-frame이라 하면, axis를 기준으로 말하는 것을 의미한다.</p>

<p>그러나 수학식으로는 나타낼때는 점변환을 기준으로 나타내며, \(T^c_b\)을 구하는 것을 의미한다.</p>

<p>Transformation을 구하기 위해 <strong>Axis를 기준으로 생각해 볼 때는</strong> 아래와 같이 rotation matrix를 계산한다.</p>

<p>[Body frame] = R * [Camera frame]</p>

<p>Translation은 어떤 frame을 기준으로 움직이느냐에 따라 추가하면 된다.</p>

<p>예를들어 body frame기준으로 x=1m가 camera frame까지 차이가 난다면,</p>

<p>[Camera frame] = T * [Body frame]에서 Body frame의 T matrix의 translation 부분의 x값을 1m 입력해주면 된다.</p>

<p>이를 종합하여 볼 때, axis를 기준으로 할때 <strong>translation이 어떤 frame기준인지 먼저 잘 살펴보고</strong>, rotation의 기준도 동일하게 정해주는 것이 좋다.</p>

<h2 id="2-rotation-matrix">2. Rotation Matrix</h2>

<p>roll : x축 기준 회전</p>

<p><img src="/images/calc-tf/Untitled.png" alt="Untitled" /></p>

<p>pitch : y축 기준 회전</p>

<p><img src="/images/calc-tf/Untitled1.png" alt="Untitled" /></p>

<p>yaw : z축 기준 회전</p>

<p><img src="/images/calc-tf/Untitled2.png" alt="Untitled" /></p>

\[R = R_{yaw} * R_{pitch} * R_{roll}\]

<p>roll → pitch → yaw순으로 회전한다.</p>

<h2 id="3-example">3. Example</h2>

<p>Camera frame TF :</p>

<p><img src="/images/calc-tf/Untitled3.png" alt="Untitled" /></p>

<p>IMU frame TF :</p>

<p><img src="/images/calc-tf/Untitled 4.png" alt="Untitled" /></p>

<p>위 두 frame의 Translation이 body기준으로 1m차이 난다고 주어졌다고 가정하자.</p>

<p>만약 Transformation Camera to body(IMU)을 구해야 하더라도, body기준으로 값이 주어졌기 때문에 Transformation body to Camera를 먼저 구하고 inverse해주는 것이 더 편리하다.</p>

<p>Body기준으로 roll 방향 90도, pitch방향 -90도 회전하면 camera frame을 구할 수 있으므로,  <br />
(<strong>counterclockwise 기준, 왼손법칙</strong>)</p>

<p>Transformation from body to camera-frame는 다음과 같이 구할 수 있다.</p>

\[T_c^b = \begin{pmatrix} 0 &amp; -1 &amp; 0 &amp; 1 \\ 0 &amp; 0 &amp; -1 &amp; 0  \\ 1 &amp; 0 &amp; 0 &amp; 0  \\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}\]

<p>따라서 원래 구하려던 Transformation from camera to body-frame를 구하려면 이를 inverse해주면 된다.</p>

\[T_b^c= \begin{pmatrix} 0 &amp; 0 &amp; 1 &amp; 0 \\ -1 &amp; 0 &amp; 0 &amp; 1  \\ 0 &amp; -1 &amp; 0 &amp; 0  \\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}\]

<p>※ 계산해주는 tools site : <a href="https://www.andre-gaschler.com/rotationconverter/">https://www.andre-gaschler.com/rotationconverter/</a></p>

<p>transformation matrix를 구할 때 위 site를 이용하여 Rotation의 각도 차이를 적어주어 구하면 편리하다.</p>

<ul>
  <li>위 계산법은 ZYX순서로 rotation을 계산하여야 한다.</li>
</ul>


  
    
      <div class="post-tags-section">
  <i class="post-tags-icon fas fa-tags"></i>
  <ul class="post-tags"><li>
        <a class="post-tag" href="/tags/#tf">tf</a></li><li>
        <a class="post-tag" href="/tags/#slam">slam</a></li></ul>
</div>

  

  
</article>


<aside class="related">
  <h2>Related posts</h2>
  <ul class="related-posts">
    
      <li>
        <a href="/abc/2020/10/02/testing-mathjax/">
          Testing MathJax
          <small><time datetime="2020-10-02T16:32:00+09:00">02 Oct 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/09/30/welcome-to-not-pure-poole/">
          Welcome to Not Pure Poole
          <small><time datetime="2020-09-30T00:18:00+09:00">30 Sep 2020</time></small>
        </a>
      </li>
    
  </ul>
</aside>


</main>

<footer class="footer"><small>
    &copy; 2020&nbsp;-&nbsp;2022 <a href="https://github.com/SeoDU/">DongUk Seo</a>. All rights reserved.
    Powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://github.com/vszhub/not-pure-poole">Not Pure Poole</a>.
  </small>
</footer>
</div>
      <div class="sidebar-right pure-u-1 pure-u-md-1-4">
</div>
    </div>

    <script async src="https://use.fontawesome.com/releases/v5.0.12/js/all.js"></script><script>
  function strip(str, remove) {
    while (str.length > 0 && remove.indexOf(str.charAt(0)) != -1) {
      str = str.substr(1);
    }
    while (str.length > 0 && remove.indexOf(str.charAt(str.length - 1)) != -1) {
      str = str.substr(0, str.length - 1);
    }
    return str;
  }

  function scroll() {
    console.log('scroll');
    window.scrollTo({
      left: 0, 
      top: window.innerHeight,
      behavior: 'smooth'
    });
    sessionStorage.removeItem('forceCheckScroll');
  }

  const forceCheckScroll = sessionStorage.getItem('forceCheckScroll') === 'true';
  const checkScroll = strip(window.location.pathname, '/') !== strip('', '/');

  if (forceCheckScroll || checkScroll) {
    const maxWidth = "(max-width: 48rem)";
    const result = window.matchMedia(maxWidth);
    if (result.matches) {
      scroll();
    } else {
      result.addListener((match) => {
        if (match.media == maxWidth) {
          if (match.matches) {
            scroll();
          }
        }
      });
    }
  }
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
